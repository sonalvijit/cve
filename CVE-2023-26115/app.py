from flask import Flask, request
import re
import time

app = Flask(__name__)
app.config['MAX_CONTENT_LENGTH'] = 64 * 1024 * 1024  # 64 MB

vulnerable_pattern = re.compile(r'(a+)+$')

@app.route("/test", methods=["POST"])
def test_redos():
     user_input = request.form.get("input", "")
     start_time = time.time()
     match = vulnerable_pattern.match(user_input)
     end = time.time()

     duration = end - start_time

     if match:
          return f"Matched: {match.group(0)} in {duration:.4f} seconds"
     else:    
          return f"No match in {duration:.4f} seconds"
     
if __name__ == "__main__":
     app.run(host="0.0.0.0", port=5000, debug=True)