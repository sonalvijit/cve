
# Flask Header Injection Lab (CVE-2023-3817 Simulation)

This project is a deliberately vulnerable Flask application designed for **educational and ethical security testing purposes only**. It simulates an HTTP header injection vulnerability similar to [CVE-2023-3817](https://nvd.nist.gov/vuln/detail/CVE-2023-3817), where improper sanitization of user input in response headers can lead to **HTTP Response Splitting** and header manipulation.

---

## 🚨 Disclaimer

> This project is **intentionally insecure**. Use it only in isolated environments (such as Docker or localhost).  
> Do **NOT** deploy this in production or on the public internet.  
> You are responsible for any misuse.

---

## 📦 Features

- Logs headers, body, and form data from incoming requests.
- Contains a `/inject` endpoint vulnerable to header injection.
- Demonstrates how improper header sanitization can result in split response headers.

---

## 🚀 Getting Started

### 1. Install Requirements

```bash
pip install Flask requests
```

### 2. Run the App

```bash
python app.py
```

The app runs on: `http://localhost:5000`

---

## 💉 Exploit the Vulnerability

Use the provided `exploit_cve2023_3817_sim.py` to trigger header injection:

```bash
python exploit_cve2023_3817_sim.py
```

You should observe injected headers like:

```
X-Attack: exploit
Set-Cookie: hacked=1
```

---

## 📁 File Structure

```
.
├── app.py                        # Vulnerable Flask app
├── exploit_cve2023_3817_sim.py  # Exploit script (ethical use only)
└── README.md                    # This file
```

---

## 🧠 How It Works

Insecure endpoint (`/inject`) reflects unvalidated query parameters into response headers:

```python
header_name = request.args.get("name")
header_value = request.args.get("value")
response.headers[header_name] = header_value
```

Malicious input like:

```
name=X-Test%0D%0ASet-Cookie:%20session=hacked
```

results in:

```
X-Test: injected
Set-Cookie: session=hacked
```

---

## 🛡️ How to Fix It

To mitigate:

- **Sanitize header names/values**.
- **Reject control characters** (``, `
`).
- Use strict regex or whitelisting for header input.

Example fix:

```python
import re
if re.search(r'[
]', header_name):
    return "Invalid header", 400
```

---

## 📚 References

- [CVE-2023-3817 - NVD](https://nvd.nist.gov/vuln/detail/CVE-2023-3817)
- [OWASP HTTP Response Splitting](https://owasp.org/www-community/attacks/HTTP_Response_Splitting)

---

## ✅ License

This project is open for educational and testing use. You may modify or distribute under fair use with attribution.
