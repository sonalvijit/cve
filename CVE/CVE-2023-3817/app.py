from flask import Flask, request

app = Flask(__name__)

@app.route("/", methods=["GET","POST"])
def index():
     data = request.get_data(as_text=True)
     print("Headers:", dict(request.headers))
     print("Form:", request.form)
     print("Data", request.data)
     return f"Received {len(data)} bytes of data\nReceived: {data}", 200

@app.route("/inject", methods=["GET"])
def inject():
     header_name = request.args.get("name","X-Vulnerable")
     header_value = request.args.get("value","test")

     response = app.make_response("Header injected (maybe)")
     response.headers[header_name] = header_value
     return response

if __name__ == "__main__":
     app.run(host="0.0.0.0", port=5000, debug=True)