<?php
/*
Plugin Name: Show Me The Cookies
Plugin URI: https://example.com
Description: Demonstration plugin vulnerable to CVE-2025-1509
Version: 1.0
Author: VulnDemo
*/

add_shortcode('show_cookie_content', function($atts) {
    return isset($_GET['smc']) ? $_GET['smc'] : 'No cookie content.';
});

// 🚨 VULNERABLE: Executes shortcode for ANY visitor without checks
add_action('init', function() {
    if (isset($_GET['smc'])) {
        echo do_shortcode('[show_cookie_content]');
        exit;
    }
});
