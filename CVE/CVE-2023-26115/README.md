# 🔥 ReDoS Vulnerability in Flask App – CVE-Style PoC

## 📌 Summary

This repository demonstrates a **Regular Expression Denial of Service (ReDoS)** vulnerability in a Flask application. The `re.match()` function is applied to user input using a *catastrophic backtracking* regex pattern, making the app susceptible to slowdown or DoS under crafted input.

---

## 🛠️ Vulnerable Code Overview

**File:** `app.py`

```python
vulnerable_pattern = re.compile(r'(a+)+$')
user_input = request.form.get("input", "")
match = vulnerable_pattern.match(user_input)
```

This regex is vulnerable to catastrophic backtracking. An input like `"aaaaaaaaaaaaaaaaaaaa!"` causes exponential matching time.

---

## 📁 Project Structure

```
ReDoS-Flask/
├── app.py         # Vulnerable Flask web app
├── exploit.py     # Script to exploit the regex for DoS
└── README.md      # This file
```

---

## 🚀 Setup Instructions

### 1. Install Dependencies

```bash
pip install Flask requests
```

### 2. Run the Flask App

```bash
python app.py
```

Server will start at: `http://localhost:5000/test`

---

## 💣 Exploit the Vulnerability

**Run `exploit.py`:**

```bash
python exploit.py
```

This sends repeated POST requests with a 1MB+ input to the regex handler, causing a delay in processing time.

---

## 🔍 How It Works

- The regex pattern `(a+)+$` is vulnerable to **catastrophic backtracking**.
- Each repeated `a` adds significant processing time when it does *not* match.
- Python’s `re` module uses backtracking, and with enough input, this can spike CPU usage and hang the app.

---

## 🛡️ Mitigation

- **Avoid ambiguous nested quantifiers** like `(a+)+`
- Use timeouts or safe regex libraries (e.g., `re2` via `safe-regex`)
- Validate input lengths before matching

```python
if len(user_input) > 1000:
    return "Input too long!", 400
```

---

## ⚠️ Disclaimer

> This project is for educational use only. Do not run this test on production environments or systems you don't own.

---

## 📚 References

- [OWASP: Regular expression Denial of Service (ReDoS)](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)
- [Catastrophic Backtracking (RegEx)](https://www.regular-expressions.info/catastrophic.html)